<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Invoice Automation Dashboard</title>
  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0B1020;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.10);
      --text:#EAF0FF;
      --muted:rgba(234,240,255,.72);
      --muted2:rgba(234,240,255,.55);
      --good:#22C55E;
      --bad:#EF4444;
      --warn:#F59E0B;
      --accent:#7C3AED;
      --accent2:#06B6D4;
      --shadow: 0 16px 45px rgba(0,0,0,.45);
      --radius: 18px;
      --radius2: 14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(124,58,237,.35), transparent 60%),
        radial-gradient(900px 500px at 80% 10%, rgba(6,182,212,.25), transparent 55%),
        radial-gradient(900px 700px at 50% 100%, rgba(34,197,94,.10), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      min-height:100vh;
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 28px 18px 56px;
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      padding: 10px 6px 18px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    h1{
      margin:0;
      font-weight: 760;
      letter-spacing: -0.02em;
      font-size: clamp(22px, 3vw, 30px);
      line-height: 1.05;
    }

    .subtitle{
      color:var(--muted);
      font-size: 14px;
      line-height: 1.35;
      max-width: 70ch;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      border: 1px solid var(--stroke);
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 16px;
      align-items:start;
    }

    @media (max-width: 980px){
      .grid{grid-template-columns: 1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .card .hd{
      padding: 16px 16px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .card .hd .left{
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .card .hd .kicker{
      color: var(--muted2);
      font-size: 12px;
      letter-spacing: .06em;
      text-transform: uppercase;
    }

    .card .hd .name{
      font-size: 16px;
      font-weight: 720;
    }

    .card .bd{
      padding: 14px 16px 16px;
      border-top: 1px solid rgba(255,255,255,.06);
    }

    .row{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
      width: 100%;
      max-width: 520px;
    }

    label{
      font-size: 12px;
      color: var(--muted2);
    }

    input[type="email"]{
      width:100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      outline: none;
      background: rgba(0,0,0,.22);
      color: var(--text);
      font-size: 14px;
    }

    input[type="email"]::placeholder{ color: rgba(234,240,255,.35); }

    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 11px 12px;
      border-radius: 12px;
      font-weight: 650;
      font-size: 14px;
      cursor:pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease, opacity .2s ease;
      display:inline-flex;
      align-items:center;
      gap: 10px;
      user-select:none;
    }

    .btn:hover{ background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.20); }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn[disabled]{ opacity:.55; cursor:not-allowed; }

    .btn.primary{
      background: linear-gradient(135deg, rgba(124,58,237,.90), rgba(6,182,212,.75));
      border-color: rgba(255,255,255,.20);
      box-shadow: 0 10px 28px rgba(124,58,237,.22);
    }
    .btn.primary:hover{ filter: brightness(1.05); }
    .btn.ghost{
      background: transparent;
      border-color: rgba(255,255,255,.14);
    }

    .btn.small{
      padding: 9px 10px;
      border-radius: 11px;
      font-size: 13px;
      font-weight: 650;
    }

    .hint{
      color: var(--muted2);
      font-size: 12px;
      line-height: 1.35;
    }

    .split{
      display:flex;
      gap:12px;
      align-items:flex-end;
      justify-content:space-between;
      flex-wrap: wrap;
    }

    .progressWrap{
      display:none;
      margin-top: 10px;
      padding: 14px 14px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }

    .progressTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .statusLine{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      color: var(--muted);
      font-size: 13px;
    }

    .mono{
      font-family: var(--mono);
      font-size: 12px;
      color: rgba(234,240,255,.78);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      padding: 6px 9px;
      border-radius: 999px;
    }

    .bar{
      height: 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      overflow:hidden;
    }
    .bar > .fill{
      height: 100%;
      width: 0%;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(124,58,237,.95), rgba(6,182,212,.90), rgba(34,197,94,.80));
      transition: width .25s ease;
    }

    .spinner{
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 2px solid rgba(255,255,255,.18);
      border-top-color: rgba(255,255,255,.85);
      animation: spin .8s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      border-radius: 999px;
      padding: 7px 10px;
      font-size: 12px;
      font-weight: 650;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      white-space: nowrap;
    }
    .badge.good{ color: rgba(34,197,94,1); border-color: rgba(34,197,94,.28); background: rgba(34,197,94,.10); }
    .badge.bad{ color: rgba(239,68,68,1); border-color: rgba(239,68,68,.28); background: rgba(239,68,68,.10); }
    .badge.run{ color: rgba(6,182,212,1); border-color: rgba(6,182,212,.28); background: rgba(6,182,212,.10); }
    .badge.wait{ color: rgba(245,158,11,1); border-color: rgba(245,158,11,.28); background: rgba(245,158,11,.10); }

    .results{
      display:none;
      margin-top: 12px;
      border-top: 1px solid rgba(255,255,255,.06);
      padding-top: 12px;
    }

    .resultItem{
      display:flex;
      gap: 10px;
      align-items:flex-start;
      padding: 10px 10px;
      border-radius: 14px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.08);
      margin-bottom: 10px;
    }

    .resultIcon{
      flex: 0 0 auto;
      width: 28px;
      height: 28px;
      display:grid;
      place-items:center;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      font-size: 14px;
      margin-top: 1px;
    }

    .resultMain{
      flex: 1 1 auto;
      min-width: 240px;
    }

    .resultTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
      font-weight: 700;
      font-size: 13px;
      margin-bottom: 4px;
    }

    .resultSub{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.35;
      word-break: break-word;
    }

    .muted{ color: var(--muted); }

    .vendorList{
      display:flex;
      flex-direction:column;
      gap: 12px;
    }

    .vendorCard{
      padding: 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.09);
      background: rgba(0,0,0,.16);
    }

    .vendorTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .vendorName{
      font-weight: 760;
      letter-spacing: -.01em;
    }

    .accounts{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .toast{
      position: fixed;
      right: 18px;
      bottom: 18px;
      z-index: 999;
      max-width: 420px;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(10,14,30,.92);
      box-shadow: var(--shadow);
      display:none;
    }
    .toast.show{ display:block; animation: pop .16s ease; }
    @keyframes pop{ from{ transform: translateY(6px); opacity: .0 } to{ transform: translateY(0); opacity: 1 } }
    .toast .tTitle{ font-weight: 750; font-size: 13px; margin-bottom: 2px; }
    .toast .tBody{ color: var(--muted); font-size: 12px; line-height: 1.35; }
    .toast.good{ border-color: rgba(34,197,94,.35); }
    .toast.bad{ border-color: rgba(239,68,68,.35); }
    .toast.wait{ border-color: rgba(245,158,11,.35); }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Invoice Automation</h1>
        <div class="subtitle">
          Download invoices from vendor portals and email them to your team. Runs are sequential and tracked live.
        </div>
      </div>
      <div class="pill" id="envPill">
        <span class="spinner" style="width:14px;height:14px"></span>
        <span>Loading…</span>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <div class="hd">
          <div class="left">
            <div class="kicker">Run</div>
            <div class="name">Batch / Single downloads</div>
          </div>
          <span class="badge wait" id="jobBadge"><span class="spinner" id="badgeSpin"></span><span id="jobBadgeText">Idle</span></span>
        </div>

        <div class="bd">
          <div class="split">
            <div class="field">
              <label for="emailInput">Send invoices to (optional override for this run)</label>
              <input id="emailInput" type="email" placeholder="name@company.com" autocomplete="email" />
              <div class="hint">
                Leave blank to use your saved default email. Saving settings is local-only for now (auth-ready).
              </div>
            </div>

            <div class="row">
              <button class="btn ghost" id="saveEmailBtn" type="button">Save default email</button>
              <button class="btn primary" id="downloadAllBtn" type="button">Download all invoices</button>
            </div>
          </div>

          <div class="progressWrap" id="progressWrap">
            <div class="progressTop">
              <div class="statusLine">
                <div class="spinner" id="runSpin"></div>
                <div id="progressText">Starting…</div>
                <div class="mono" id="jobIdChip" title="Job ID">job: —</div>
              </div>
              <div class="mono" id="percentChip">0%</div>
            </div>

            <div class="bar" aria-label="Progress">
              <div class="fill" id="progressFill"></div>
            </div>

            <div class="results" id="resultsWrap">
              <div class="muted" style="margin: 8px 0 10px; font-size: 12px;">Results</div>
              <div id="resultsList"></div>
            </div>
          </div>
        </div>
      </section>

      <aside class="card">
        <div class="hd">
          <div class="left">
            <div class="kicker">Quick actions</div>
            <div class="name">Download an individual account</div>
          </div>
          <button class="btn small" id="refreshVendorsBtn" type="button">Refresh</button>
        </div>

        <div class="bd">
          <div class="vendorList" id="vendorList">
            <div class="muted">Loading vendors…</div>
          </div>
          <div class="hint" style="margin-top: 10px;">
            Individual runs use the same email field override (or your saved default if blank).
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast">
    <div class="tTitle" id="toastTitle"></div>
    <div class="tBody" id="toastBody"></div>
  </div>

  <script>
    let activeJobId = null;
    let pollTimer = null;
    let lastResultsSignature = "";
    let cachedUser = null;

    const $ = (id) => document.getElementById(id);

    function setBadge(mode, text) {
      const badge = $("jobBadge");
      const spin = $("badgeSpin");
      const label = $("jobBadgeText");
      label.textContent = text;
      badge.classList.remove("good","bad","run","wait");
      if (mode) badge.classList.add(mode);
      spin.style.display = (mode === "run" || mode === "wait") ? "inline-block" : "none";
    }

    function toast(type, title, body) {
      const t = $("toast");
      t.classList.remove("good","bad","wait","show");
      if (type) t.classList.add(type);
      $("toastTitle").textContent = title || "";
      $("toastBody").textContent = body || "";
      t.classList.add("show");
      window.clearTimeout(t._timer);
      t._timer = window.setTimeout(() => t.classList.remove("show"), 3400);
    }

    function normalizeVendor(v) {
      return (v || "").toString().trim().toLowerCase();
    }

    function formatVendor(v) {
      const s = normalizeVendor(v);
      if (!s) return "—";
      return s.toUpperCase();
    }

    function getEmailOverride() {
      const raw = $("emailInput").value || "";
      const email = raw.trim();
      return email.length ? email : null;
    }

    function disableWhileRunning(isRunning) {
      $("downloadAllBtn").disabled = isRunning;
      $("saveEmailBtn").disabled = isRunning;
      $("refreshVendorsBtn").disabled = isRunning;
      document.querySelectorAll("[data-action='single']").forEach(btn => btn.disabled = isRunning);
    }

    function showProgress(show) {
      $("progressWrap").style.display = show ? "block" : "none";
      if (!show) {
        $("resultsWrap").style.display = "none";
        $("resultsList").innerHTML = "";
        $("progressFill").style.width = "0%";
        $("percentChip").textContent = "0%";
        $("progressText").textContent = "Idle";
        $("jobIdChip").textContent = "job: —";
        lastResultsSignature = "";
      }
    }

    function renderResults(results) {
      const list = $("resultsList");
      list.innerHTML = "";
      if (!Array.isArray(results) || results.length === 0) {
        list.innerHTML = '<div class="muted" style="font-size:12px;">No results yet.</div>';
        return;
      }

      const sorted = [...results].sort((a,b) => {
        const av = normalizeVendor(a.vendor), bv = normalizeVendor(b.vendor);
        if (av < bv) return -1;
        if (av > bv) return 1;
        return (a.account ?? 0) - (b.account ?? 0);
      });

      for (const r of sorted) {
        const ok = r.status === "success";
        const icon = ok ? "✅" : "❌";
        const badge = ok ? '<span class="badge good">Success</span>' : '<span class="badge bad">Failed</span>';
        const title = `${formatVendor(r.vendor)} — Account #${(r.account ?? 0) + 1}`;
        const sub = ok ? (r.filename ? r.filename : "Downloaded")
                       : (r.error ? `Error: ${r.error}` : "Error");

        const div = document.createElement("div");
        div.className = "resultItem";
        div.innerHTML = `
          <div class="resultIcon">${icon}</div>
          <div class="resultMain">
            <div class="resultTitle">
              <span>${title}</span>
              ${badge}
            </div>
            <div class="resultSub">${escapeHtml(sub)}</div>
          </div>
        `;
        list.appendChild(div);
      }
    }

    function escapeHtml(str) {
      return String(str || "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function signatureForResults(results) {
      try { return JSON.stringify(results || []); } catch { return String(Math.random()); }
    }

    async function apiGet(path) {
      const res = await fetch(path, { method: "GET", headers: { "Accept": "application/json" } });
      const data = await res.json().catch(() => ({}));
      if (!res.ok) throw new Error((data && (data.error || data.message)) || `HTTP ${res.status}`);
      return data;
    }

    async function apiPost(path, bodyObj) {
      const res = await fetch(path, {
        method: "POST",
        headers: { "Content-Type": "application/json", "Accept": "application/json" },
        body: JSON.stringify(bodyObj || {})
      });
      const data = await res.json().catch(() => ({}));
      if (!res.ok) {
        const err = new Error((data && (data.error || data.message)) || `HTTP ${res.status}`);
        err.status = res.status;
        throw err;
      }
      return data;
    }

    async function startJob(payload) {
      lastResultsSignature = "";
      $("resultsWrap").style.display = "none";
      $("resultsList").innerHTML = "";

      setBadge("wait", "Starting");
      showProgress(true);
      $("runSpin").style.display = "inline-block";
      $("progressText").textContent = "Starting job…";
      $("progressFill").style.width = "0%";
      $("percentChip").textContent = "0%";
      disableWhileRunning(true);

      try {
        const resp = await apiPost("/api/start-job", payload);
        activeJobId = resp.job_id;
        $("jobIdChip").textContent = `job: ${activeJobId}`;
        toast("wait", "Job started", "Running automation. You can keep this tab open for live updates.");
        setBadge("run", "Running");
        beginPolling(activeJobId);
      } catch (e) {
        if (e.status === 409) toast("wait", "Already running", e.message || "A job is already running.");
        else toast("bad", "Could not start job", e.message || "Start failed.");
        setBadge(null, "Idle");
        disableWhileRunning(false);
        showProgress(false);
        throw e;
      }
    }

    function beginPolling(jobId) {
      stopPolling();
      pollTimer = window.setInterval(() => pollJob(jobId), 2000);
      pollJob(jobId);
    }

    function stopPolling() {
      if (pollTimer) {
        window.clearInterval(pollTimer);
        pollTimer = null;
      }
    }

    async function pollJob(jobId) {
      try {
        const resp = await apiGet(`/api/job-status/${encodeURIComponent(jobId)}`);
        const job = resp.job;

        const total = job.total_accounts || 0;
        const done = job.completed_accounts || 0;
        const pct = (job.percent_complete != null) ? job.percent_complete : (total ? Math.round((done/total)*100) : 0);
        const label = job.current_label || (job.current_vendor ? `${formatVendor(job.current_vendor)} — Account #${(job.current_account||0)+1}` : "…");

        $("percentChip").textContent = `${pct}%`;
        $("progressFill").style.width = `${Math.min(100, Math.max(0, pct))}%`;

        let statusText = "";
        if (job.status === "pending") statusText = "Pending…";
        if (job.status === "running") statusText = `Running: ${label}`;
        if (job.status === "completed") statusText = "Completed";
        if (job.status === "failed") statusText = "Failed";

        $("progressText").textContent = `${done} out of ${total} accounts completed • ${statusText}`;

        const sig = signatureForResults(job.results);
        if (sig !== lastResultsSignature) {
          lastResultsSignature = sig;
          $("resultsWrap").style.display = "block";
          renderResults(job.results);
        }

        if (job.status === "running" || job.status === "pending") {
          setBadge("run", "Running");
          $("runSpin").style.display = "inline-block";
          disableWhileRunning(true);
          return;
        }

        stopPolling();
        $("runSpin").style.display = "none";
        disableWhileRunning(false);

        const results = Array.isArray(job.results) ? job.results : [];
        const successCount = results.filter(r => r.status === "success").length;
        const failCount = results.filter(r => r.status === "failed").length;

        if (job.status === "completed") {
          setBadge("good", "Completed");
          toast("good", "Run complete", `Success: ${successCount} • Failed: ${failCount}`);
        } else {
          setBadge("bad", "Failed");
          toast("bad", "Run failed", job.error_message || "Job failed.");
        }

        activeJobId = null;

      } catch (e) {
        stopPolling();
        $("runSpin").style.display = "none";
        setBadge("bad", "Error");
        disableWhileRunning(false);
        toast("bad", "Status error", e.message || "Could not fetch job status.");
      }
    }

    async function loadMe() {
      const resp = await apiGet("/api/me");
      cachedUser = resp.user || null;
      const email = (cachedUser && cachedUser.settings && cachedUser.settings.default_email_to) ? cachedUser.settings.default_email_to : "";
      $("emailInput").value = email;
      $("envPill").innerHTML = '<span style="display:inline-block;width:8px;height:8px;border-radius:99px;background:rgba(34,197,94,.9);box-shadow:0 0 0 4px rgba(34,197,94,.12)"></span><span>Ready • local</span>';
    }

    async function saveDefaultEmail() {
      const email = getEmailOverride();
      const payload = { default_email_to: email || "" };
      try {
        const resp = await apiPost("/api/settings", payload);
        const saved = (resp.settings && resp.settings.default_email_to) ? resp.settings.default_email_to : "";
        $("emailInput").value = saved;
        toast("good", "Saved", saved ? `Default email set to ${saved}` : "Default email cleared.");
      } catch (e) {
        toast("bad", "Save failed", e.message || "Could not save settings.");
      }
    }

    async function loadVendors() {
      const list = $("vendorList");
      list.innerHTML = '<div class="muted">Loading vendors…</div>';
      try {
        const resp = await apiGet("/api/vendors");
        const vendors = resp.vendors || [];
        if (!vendors.length) {
          list.innerHTML = '<div class="muted">No vendors configured.</div>';
          return;
        }
        list.innerHTML = "";
        for (const v of vendors) {
          const card = document.createElement("div");
          card.className = "vendorCard";
          const name = v.display_name || formatVendor(v.name);
          const accounts = Array.isArray(v.accounts) ? v.accounts : [];
          card.innerHTML = `
            <div class="vendorTop">
              <div>
                <div class="vendorName">${escapeHtml(name)}</div>
                <div class="hint">Accounts: ${accounts.length}</div>
              </div>
            </div>
            <div class="accounts"></div>
          `;
          list.appendChild(card);

          const accWrap = card.querySelector(".accounts");
          if (!accounts.length) {
            accWrap.innerHTML = '<span class="muted" style="font-size:12px;">No accounts.</span>';
          } else {
            for (const idx of accounts) {
              const btn = document.createElement("button");
              btn.className = "btn small";
              btn.type = "button";
              btn.dataset.action = "single";
              btn.textContent = `Download #${Number(idx) + 1}`;
              btn.addEventListener("click", () => {
                const email_to = getEmailOverride();
                return startJob({
                  mode: "single",
                  vendor: v.name,
                  account: idx,
                  email_to: email_to
                });
              });
              accWrap.appendChild(btn);
            }
          }
        }
      } catch (e) {
        list.innerHTML = `<div class="muted">Failed to load vendors: ${escapeHtml(e.message || "error")}</div>`;
      }
    }

    $("downloadAllBtn").addEventListener("click", () => {
      const email_to = getEmailOverride();
      return startJob({ mode: "all", email_to: email_to });
    });

    $("saveEmailBtn").addEventListener("click", saveDefaultEmail);
    $("refreshVendorsBtn").addEventListener("click", loadVendors);

    (async function init() {
      setBadge(null, "Idle");
      showProgress(false);
      try {
        await loadMe();
      } catch (e) {
        $("envPill").innerHTML = '<span style="display:inline-block;width:8px;height:8px;border-radius:99px;background:rgba(239,68,68,.9);box-shadow:0 0 0 4px rgba(239,68,68,.12)"></span><span>Backend not reachable</span>';
        toast("bad", "Backend not reachable", "Make sure Flask is running on localhost:5000.");
      }
      await loadVendors();
    })();
  </script>
</body>
</html>